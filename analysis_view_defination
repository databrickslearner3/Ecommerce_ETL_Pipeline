CREATE OR REPLACE VIEW ecommerce.gold.transactions_enriched AS (
  SELECT 
    i.*,
    -- Date Dimension Columns
    c.year,
    c.month_name,
    c.day_name,
    c.is_weekend,
    c.quarter,
    c.week,
    -- Product Dimension Columns
    p.sku, 
    p.category_code,
    p.category_name,
    p.brand_code,
    p.brand_name,
    p.color,
    p.size,
    p.rating_count,
    -- Customer Dimension Columns
    cust.country,
    cust.state,
    cust.phone,
    cust.country_code,
    cust.region,
    -- Calculated Column
    EXTRACT(HOUR FROM i.transaction_ts) AS hour_of_day
  FROM ecommerce.gold.gld_fact_order_items i 
  JOIN ecommerce.gold.gld_dim_date c 
    ON i.date_id = c.date_id
  JOIN ecommerce.gold.gld_dim_products p 
    ON i.product_id = p.product_id
  JOIN ecommerce.gold.gld_dim_customers cust 
    ON i.customer_id = cust.customer_id
);